%script{:src=>url_for('/scripts/jquery-2.1.1.min.js')}
%script{:src=>url_for('/scripts/jquery.dataTables.min.js')}
%script{:src=>url_for('/scripts/dataTables.bootstrap.js')}
%link{:rel=>'stylesheet', :href=>url_for('/css/dataTables.bootstrap.css')}
:javascript
  $(function() {
    $('#nodesTable').dataTable({
      "dom": '<"H"flr>tip',
      "lengthMenu": [[50, 250, 500, -1], [50, 250, 500, "All"]]
    });
  });
%div{:class=>'row tbl-header'}
  %div{:class=>'col-xs-12 col-md-2'}
    %h4 nodes /
  %div{:class=>'col-xs-12 col-md-10'}
    %a{:class=>"btn btn-default tbl-action col-xs-12 col-md-2 col-md-offset-10", :id=>"reload", :href=>url_for("/nodes")}
      %span{:class=>"glyphicon glyphicon-repeat"}
      Refresh
%div{:class=>'row'}
  %table{:id=>'nodesTable', :class=>'table table-responsive tablesorter'}
    %thead
      %tr
        %th Name
        %th IP
        %th Group
        %th Last Status
        %th Last Update
        %th Config
        %th Update
    %tbody
      -trclass = %w(even odd)
      -@data.sort_by{|e|e[:name]}.each do |node|
        -klass = trclass.rotate!.first
        %tr{:class=>"#{klass} ox-status-#{node[:status]}"}
          %td
            %a{:href => url_for("/node/show/#{node[:name]}") } #{node[:name]}
          %td= node[:ip]
          %td= node[:group]
          %td= node[:status]
          %td= node[:time]
          %td
            %a{:href => url_for("/node/fetch/#{node[:full_name]}") }
              %span{:class=>'glyphicon glyphicon-cloud-download'}
          %td
            %a{:href => url_for("/node/next/#{node[:name]}") }
              %span{:class=>'glyphicon glyphicon-repeat'}
